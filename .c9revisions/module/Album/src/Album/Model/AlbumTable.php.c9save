{"ts":1360308924466,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1360308935900,"patch":[[{"diffs":[[1,"<?php\r\nnamespace Album\\Model;\r\n\r\nuse Zend\\Db\\TableGateway\\TableGateway;\r\n\r\nclass AlbumTable\r\n{\r\n    protected $tableGateway;\r\n\r\n    public function __construct(TableGateway $tableGateway)\r\n    {\r\n        $this->tableGateway = $tableGateway;\r\n    }\r\n\r\n    public function fetchAll()\r\n    {\r\n        $resultSet = $this->tableGateway->select();\r\n        return $resultSet;\r\n    }\r\n\r\n    public function getAlbum($id)\r\n    {\r\n        $id  = (int) $id;\r\n        $rowset = $this->tableGateway->select(array('id' => $id));\r\n        $row = $rowset->current();\r\n        if (!$row) {\r\n            throw new \\Exception(\"Could not find row $id\");\r\n        }\r\n        return $row;\r\n    }\r\n\r\n    public function saveAlbum(Album $album)\r\n    {\r\n        $data = array(\r\n            'artist' => $album->artist,\r\n            'title'  => $album->title,\r\n        );\r\n\r\n        $id = (int)$album->id;\r\n        if ($id == 0) {\r\n            $this->tableGateway->insert($data);\r\n        } else {\r\n            if ($this->getAlbum($id)) {\r\n                $this->tableGateway->update($data, array('id' => $id));\r\n            } else {\r\n                throw new \\Exception('Form id does not exist');\r\n            }\r\n        }\r\n    }\r\n\r\n    public function deleteAlbum($id)\r\n    {\r\n        $this->tableGateway->delete(array('id' => $id));\r\n    }\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":1320}]],"length":1320,"saved":false}
